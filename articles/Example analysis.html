<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="STTileMaker">
<title>How to use STTileMaker + an Example Analysis • STTileMaker</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use STTileMaker + an Example Analysis">
<meta property="og:description" content="STTileMaker">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">STTileMaker</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Example%20analysis.html">How to use STTileMaker + an Example Analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to use STTileMaker + an Example Analysis</h1>
            
      
      
      <div class="d-none name"><code>Example analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="goal-of-this-analysis">Goal of this Analysis<a class="anchor" aria-label="anchor" href="#goal-of-this-analysis"></a>
</h2>
<p>In my current rotation project within Dr. Jean Fan’s lab, I am tasked
with predicting gene expression levels by analyzing H&amp;E-stained
images through the lens of spatial transcriptomics (ST) data. To
accomplish this, I have employed a technique known as <a href="https://pubmed.ncbi.nlm.nih.gov/35849101/" class="external-link">Hist2ST</a>, a method
established in 2022 and widely recognized for its usefulness in Python
environments. Despite initial challenges in deciphering and adapting the
Hist2ST code for our data sets, I (finally) successfully ran Hist2ST on
our data.</p>
<p>A pivotal component of my work involved developing a function to
segment the ST data into distinct “tiles” according to the spatial
positioning of each spot.</p>
<p>Recognizing that a significant portion of the ST research community
prefers R for data analysis, I was motivated to enhance the
accessibility and applicability of my workflow. This led to the creation
of an analogous function in R, which I have aptly named STTileMaker.</p>
<p>The STTileMaker package is designed with a straightforward objective:
to generate segmented tiles from H&amp;E images that align with the
precise locations of the spots within. Further, it can successfully read
in all ST data to therefore be used in future downstream analysis. This
capability sets the stage for a broad spectrum of subsequent analytical
procedures, including the correlation of RGB values and gene expression,
classification of spot characteristics, and the eventual integration of
these tiles into an R-based algorithm poised to predict gene expression
patterns. In the context of this data analysis, I will be demonstrating
how gene expression correlates with RGB intensity within an H&amp;E
image.</p>
<p>Questions in the analysis then become:</p>
<ol style="list-style-type: decimal">
<li><p>What gene is most correlated to RGB intensities in an H&amp;E
image?</p></li>
<li><p>What gene is least correlated to RGB intensities in an H&amp;E
image?</p></li>
<li><p>Does one channel predict better than others?</p></li>
</ol>
<p>The data of interest is freely accessible from the <a href="https://www.atlas-d2k.org/chaise/record/#2/RNASeq:Experiment/RID=17-H1QC" class="external-link">(Re)Building
a Kidney Consortium database</a>, offering a comprehensive spatial gene
expression profile created using Space Ranger 1.2.1. The data
encapsulates gene expression from the kidneys of an 8-10 week old
C57BL6/J female mouse, specifically captured at the 12-hour mark
following bilateral ischemia reperfusion injury. For detailed insights,
including a data dictionary and the data’s structure, I encourage
visiting the provided link.</p>
<p>Due to the large size of the dataset, it was not possible to host it
on GitHub. Nonetheless, I’ve included a snippet of code that, when
executed, will facilitate the direct download of the dataset into a
locally designated folder named “data.” I hope this proves helpful!</p>
</div>
<div class="section level2">
<h2 id="reading-in-the-data">Reading in the Data<a class="anchor" aria-label="anchor" href="#reading-in-the-data"></a>
</h2>
<p>Now, lets begin the analysis. First we will read in all the necassary
packages for the analysis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhu-statprogramming-fall-2023.github.io/biostat777-project3-part1-calebhallinan/">STTileMaker</a></span><span class="op">)</span> <span class="co"># custom functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># for data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span> <span class="co"># for file archiving</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilHvitfeldt/paletteer" class="external-link">paletteer</a></span><span class="op">)</span> <span class="co"># for colors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel" class="external-link">ggrepel</a></span><span class="op">)</span> <span class="co"># for plotting</span></span></code></pre></div>
<p>The code below is the code snippit that will gather the data from the
website and save it to a folder called “data.” This step is crucial for
the analysis, as we are obtaining the dataset. However, you are free to
use any ST dataset you would like for STTileMaker.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if file doesn't exist, download the data</span></span>
<span><span class="co"># if (!file.exists(here("data/f12hr_140_processed/"))) {</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"~/Desktop/jhu/rotations/fan/STTileMaker/data/f12hr_140_processed/outs/"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># message it wasn't found</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"File not found, downloading now..."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># create dir if needed</span></span>
<span>  <span class="co"># dir.create(here("data/"))</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"~/Desktop/jhu/rotations/fan/STTileMaker/data/"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># URL of the file</span></span>
<span>  <span class="va">url</span> <span class="op">=</span> <span class="st">"https://www.atlas-d2k.org/hatrac/resources/rnaseq/study/17-E9P0/study_files/64ee25aacce94ff9a42850f158097813.tar.gz:JW6WAUMAZJ5TT3SF2LGG3C6V2U"</span></span>
<span></span>
<span>  <span class="co"># Destination file path (you can change this to your desired path and filename)</span></span>
<span>  <span class="co"># dest_file = here("data/downloaded_file.tar.gz")</span></span>
<span>  <span class="va">dest_file</span> <span class="op">=</span> <span class="st">"~/Desktop/jhu/rotations/fan/STTileMaker/data/downloaded_file.tar.gz"</span></span>
<span></span>
<span>  <span class="co"># Download the file</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">url</span>, <span class="va">dest_file</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Assuming the file is named "downloaded_file.tar.gz" and is in the current working directory</span></span>
<span>  <span class="va">file_name</span> <span class="op">=</span> <span class="st">"downloaded_file.tar.gz"</span></span>
<span></span>
<span>  <span class="co"># Extract the file</span></span>
<span>  <span class="co"># untar(here("data/downloaded_file.tar.gz"), exdir = here("data/"))</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/untar.html" class="external-link">untar</a></span><span class="op">(</span><span class="va">dest_file</span>, exdir <span class="op">=</span> <span class="st">"~/Desktop/jhu/rotations/fan/STTileMaker/data/"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># tarfile_list = untar(file_name, list = TRUE)</span></span>
<span>  <span class="co"># print(tarfile_list)</span></span>
<span></span>
<span>  <span class="co"># message when done</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Finished!"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Since we have all the data downloaded, we are ready to read it in
with the “STTileMaker_read_data” function within the package. The object
“data” within the code, which is our read in data, is a list of lists
containing important features needed such as spot positions, cleaned
expression data, etc. For all functions within the package please take a
look at the docs section for more details.</p>
<p>After the data is read in, we can create the tiles from each spot’s
location by running the “STTileMaker_make_tiles” function. The output is
a list of images, where each image is a “tile” or “patch” of the H&amp;E
image that contains a single spot. To ensure it worked successfully, we
run the “STTileMaker_plot_tile” function to plot a single tile to
view.</p>
<p>NOTE: Unfortunately, R-markdown would not allow me to knit this was
the function here(). Therefore, if you would like to replicate this code
you NEED to change the directory to where your data is located.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in data</span></span>
<span><span class="co"># data = STTileMaker_read_data(here::here("data/f12hr_140_processed/outs/"))</span></span>
<span><span class="va">data</span> <span class="op">=</span><span class="fu"><a href="../reference/STTileMaker_read_data.html">STTileMaker_read_data</a></span><span class="op">(</span><span class="st">"~/Desktop/jhu/rotations/fan/STTileMaker/data/f12hr_140_processed/outs/"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Gene Matrix Dimensions: 32285" "Gene Matrix Dimensions: 1893" </span></span>
<span><span class="co">#&gt;                       x    y</span></span>
<span><span class="co">#&gt; CTATGTCTATTGAAAC-1 4609 2032</span></span>
<span><span class="co">#&gt; TGTCCCGACATAGCAC-1 4746 2032</span></span>
<span><span class="co">#&gt; ATATTCCCACAGGTCA-1 4883 2033</span></span>
<span><span class="co">#&gt; CACCATCGGAGGAGAC-1 5020 2033</span></span>
<span><span class="co">#&gt; CTTAACTTCGAAGTAC-1 5158 2034</span></span>
<span><span class="co">#&gt; TACCAGCTAGGTTTAA-1 5295 2034</span></span>
<span></span>
<span><span class="co"># make tiles</span></span>
<span><span class="va">tiles</span> <span class="op">=</span> <span class="fu"><a href="../reference/STTileMaker_make_tiles.html">STTileMaker_make_tiles</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Making tiles..."</span></span>
<span><span class="co">#&gt; [1] "Done!"</span></span>
<span></span>
<span><span class="co"># check to see it works</span></span>
<span><span class="fu"><a href="../reference/STTileMaker_plot_tile.html">STTileMaker_plot_tile</a></span><span class="op">(</span><span class="va">tiles</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/STTileMaker_plot_tile.html">STTileMaker_plot_tile</a></span><span class="op">(</span><span class="va">tiles</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-3-2.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># it works!!</span></span></code></pre></div>
<p>As the package continues to evolve, additional functions will be
incorporated. However, the above selection represents the full range of
functionalities available at this moment.</p>
<p>Now let’s begin the analysis!</p>
</div>
<div class="section level2">
<h2 id="data-analysis">Data Analysis<a class="anchor" aria-label="anchor" href="#data-analysis"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># grab the mean of each red channel in each tile</span></span>
<span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">tiles</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># red channel</span></span>
<span></span>
<span><span class="co"># set names of the features</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tiles</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the histogram </span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">features</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Mean Value of Red Channel"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Mean Values of Tiles within the Red Channel"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean values of the red channel per tile. Note that it is fairly high for all tiles</span></span>
<span><span class="st">                               located within tissue and is characterized by a normal distribution."</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data Source: Kidney Consortium database"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.title <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The first plot shown above is a distribution of the mean values of
the red channel. We see that it is normally distributed with a fairly
high mean (range is 0-1).</p>
<p>Next we see the distribution of correlation between the red channel
and gene expression per tile. Unfortunately, we see that there is no
strong correlation with any genes within the red channel. However, the
red channel was found to be the best correlated channel with gene
expression compared to blue and green. The other two channel results are
not shown here, so I encourage you to try for yourself to confirm!</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># normalize the data</span></span>
<span><span class="va">normFactor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">geneCountsClean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">geneCountsClean</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">normFactor</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">mat</span> <span class="op">*</span> <span class="fl">1e6</span> <span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get correlation of each tile with gene expression</span></span>
<span><span class="va">cors_list</span> <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="va">.x</span>, <span class="op">]</span>, <span class="va">features</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Convert the list to a numeric vector</span></span>
<span><span class="va">cors</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">cors_list</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># plot the histogram </span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">cors</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cors</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Correlation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean Correlation between the Red Channel and Gene Expression"</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Correlation histogram of gene expression with the tissue and </span></span>
<span><span class="st">                               red channel values. Note the little deviation from 0, as only a few</span></span>
<span><span class="st">                               genes are found to be correlated."</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data Source: Kidney Consortium database"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.title <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Next, I wanted to see what the highest correlated gene and lowest
correlated gene was when looking at the red channel.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get best correlated gene</span></span>
<span><span class="co"># Assuming 'cors' is a named numeric vector</span></span>
<span><span class="va">cors_df</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, value <span class="op">=</span> <span class="va">cors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finding the names with the minimum 'cors' value</span></span>
<span><span class="va">g_max</span> <span class="op">=</span> <span class="va">cors_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get scaled expression of gene</span></span>
<span><span class="va">ggexp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="va">g_max</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># get locations</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">posClean</span>, <span class="va">ggexp</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Calculate the correlation coefficient</span></span>
<span><span class="va">corr_coefficient</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="va">g_max</span>, <span class="op">]</span>, <span class="va">features</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span><span class="op">[</span><span class="va">g_max</span>,<span class="op">]</span>, y <span class="op">=</span> <span class="va">features</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span><span class="op">[</span><span class="va">g_max</span>,<span class="op">]</span>, y <span class="op">=</span> <span class="va">features</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Log Gene Expression"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean value of Red Channel"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Correlation of "</span>,<span class="va">g_max</span>,<span class="st">" Expression and Mean Red Channel value"</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean expression per tile of gene "</span>, <span class="va">g_max</span>,<span class="st">". This is the most correlated gene</span></span>
<span><span class="st">                               with the red channel values."</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data Source: Kidney Consortium database"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, y <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Correlation: %.2f"</span>, <span class="va">corr_coefficient</span><span class="op">)</span>, </span>
<span>           hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>, size <span class="op">=</span> <span class="fl">5</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># customize theme</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.title <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>As we see, the highest correlated gene was Kap with a correlation of
0.41. While this is not particularly a strong correlation, it is better
than nothing and serves as a great base for future analysis! We see
there are lots of spots within the tissue that has 0 expression, with a
big leap to a log expression of 2 or higher. Very interesting to see,
and something that is worth diving into more to understand!</p>
<p>Now let’s see what the highest correlated gene, Kap, looks like on
the tissue.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># now we can plot with the image</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">rasterGrob</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">img</span>,</span>
<span>                      interpolate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                      height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># plot actual image</span></span>
<span><span class="va">plt</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span></span>
<span>        grob <span class="op">=</span> <span class="va">x</span>,</span>
<span>        xmin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">raster</span><span class="op">)</span>,</span>
<span>        ymin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">raster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span></span>
<span>        xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">raster</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">raster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot expression of gene</span></span>
<span><span class="va">plt</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">ggexp</span><span class="op">)</span>,</span>
<span>                 size <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">r</span><span class="op">/</span><span class="fl">5</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradient2</a></span><span class="op">(</span></span>
<span>        low <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>        mid <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>        high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean Expression of "</span>,<span class="va">g_max</span>,<span class="st">" per Spot"</span><span class="op">)</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"Mean Expression"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># customize theme</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.title <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>This awesome figure allows us to see spatially where the gene is
highly expressed and lowly expressed. Interestingly, this gene has high
expression within the tissue with lower expression on the outside. We
see essentially a gradient of expression of this gene, which is
certainly a cool find. Remember that the red channel was able to do
pretty well when comparing it to this genes expression with a
correlation of 0.41.</p>
<p>Let’s do the same thing with the least correlated gene!</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get worst correlated gene</span></span>
<span></span>
<span><span class="co"># Finding the names with the minimum 'cors' value</span></span>
<span><span class="va">g_min</span> <span class="op">=</span> <span class="va">cors_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get scaled expression of gene</span></span>
<span><span class="va">ggexp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="va">g_min</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># get locations</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">posClean</span>, <span class="va">ggexp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the correlation coefficient</span></span>
<span><span class="va">corr_coefficient</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="va">g_min</span>, <span class="op">]</span>, <span class="va">features</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span><span class="op">[</span><span class="va">g_min</span>,<span class="op">]</span>, y <span class="op">=</span> <span class="va">features</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span><span class="op">[</span><span class="va">g_min</span>,<span class="op">]</span>, y <span class="op">=</span> <span class="va">features</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Log Gene Expression"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean value of Red Channel"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Correlation of "</span>,<span class="va">g_min</span>,<span class="st">" Expression and Mean Red Channel value"</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean expression per tile of gene "</span>, <span class="va">g_min</span>,<span class="st">". This is the least correlated gene</span></span>
<span><span class="st">                               with the red channel values."</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data Source: Kidney Consortium database"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, y <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Correlation: %.2f"</span>, <span class="va">corr_coefficient</span><span class="op">)</span>, </span>
<span>           hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>, size <span class="op">=</span> <span class="fl">5</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># customize theme</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.title <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>With a correlation of -0.27, Igfbp5 was was the least correlated gene
when comparing gene expression with red channel intensity. We see here a
lot of tiles that did not contain any expression of this gene, with
those tiles that did displaying a clear negative relationship.</p>
<p>Let’s take a look at the gene expression on the tissue just to have
an idea of what it would look like.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot expression of gene</span></span>
<span><span class="va">plt</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">ggexp</span><span class="op">)</span>,</span>
<span>                 size <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">r</span><span class="op">/</span><span class="fl">5</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradient2</a></span><span class="op">(</span></span>
<span>        low <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>        mid <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>        high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean Expression of "</span>,<span class="va">g_min</span>,<span class="st">" per Spot"</span><span class="op">)</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"Mean Expression"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># customize theme</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.title <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Well, it is of no surprise that it isn’t very good! To me, it seems a
bit sporadic and all over the place so we would likely not use this gene
for any more downstream analysis.</p>
<p>Finally, I wanted to show one more feature I looked at in this
analysis: the red channel mean expression minus the blue channel.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># grab the mean of each red channel in each tile</span></span>
<span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">tiles</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[</span>,,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># red channel - blue channel</span></span>
<span></span>
<span><span class="co"># set names of the features</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tiles</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get correlation of each tile with gene expression</span></span>
<span><span class="va">cors_list</span> <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="va">.x</span>, <span class="op">]</span>, <span class="va">features</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Convert the list to a numeric vector</span></span>
<span><span class="va">cors</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">cors_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get best correlated gene</span></span>
<span><span class="co"># Assuming 'cors' is a named numeric vector</span></span>
<span><span class="va">cors_df</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, value <span class="op">=</span> <span class="va">cors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finding the names with the minimum 'cors' value</span></span>
<span><span class="va">g_max</span> <span class="op">=</span> <span class="va">cors_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get scaled expression of gene</span></span>
<span><span class="va">ggexp_max</span> <span class="op">=</span> <span class="va">mat</span><span class="op">[</span><span class="va">g_max</span>,<span class="op">]</span></span>
<span><span class="co"># get locations</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">posClean</span>, <span class="va">ggexp_max</span><span class="op">)</span></span>
<span><span class="co"># Use the rename function from dplyr</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">g_max</span> <span class="op">:=</span> <span class="va">ggexp_max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finding the names with the minimum 'cors' value</span></span>
<span><span class="va">g_min</span> <span class="op">=</span> <span class="va">cors_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get scaled expression of gene</span></span>
<span><span class="va">ggexp_min</span> <span class="op">=</span> <span class="va">mat</span><span class="op">[</span><span class="va">g_min</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># bind columns together</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">df</span>,<span class="va">ggexp_min</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">df</span>,<span class="va">features</span><span class="op">)</span></span>
<span><span class="co"># rename</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">==</span> <span class="st">"...4"</span><span class="op">]</span> <span class="op">=</span> <span class="va">g_min</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">==</span> <span class="st">"...5"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"redminusblue"</span></span>
<span></span>
<span></span>
<span><span class="co"># Transform data to long format</span></span>
<span><span class="va">long_data</span> <span class="op">=</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"gene"</span>, value <span class="op">=</span> <span class="st">"expression"</span>, <span class="va">g_max</span>, <span class="va">g_min</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the plot with ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">long_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression</span>, y <span class="op">=</span> <span class="va">redminusblue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Log Gene Expression"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean value of Red Channel minus Blue Channel"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean Correlation between Red minus Blue Channel and Gene Expression"</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Two plots are displayed with the highest correlated gene, "</span>, <span class="va">g_max</span>,<span class="st">", with a </span></span>
<span><span class="st">                               correlation of "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cors_df</span><span class="op">$</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                               <span class="st">", and the lowest correlated gene, "</span>,<span class="va">g_min</span>,<span class="st">" with a correlation of</span></span>
<span><span class="st">                               "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">cors_df</span><span class="op">$</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                               <span class="st">"."</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">95</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data Source: Kidney Consortium database"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.title <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Oddly enough, we found that there were genes with a higher
correlation when using the mean red channel values minus the blue
channel values. The two shown above are the most highly correlated gene
and the least correlated gene.</p>
</div>
<div class="section level2">
<h2 id="final-thoughts">Final Thoughts<a class="anchor" aria-label="anchor" href="#final-thoughts"></a>
</h2>
<p>In our data analysis demonstration, we illustrated the effective
execution of all functions within STTileMaker, leveraging this tool to
initiate a spatial transcriptomics (ST) data analysis, and presented
some compelling findings. Moving forward, we aim to expand the package’s
capabilities by introducing additional functions and enhancements for
more sophisticated analysis of ST tile data.</p>
</div>
<div class="section level2">
<h2 id="functions-used">Functions Used<a class="anchor" aria-label="anchor" href="#functions-used"></a>
</h2>
<p><em>You must use at least six different functions from dplyr, tidyr,
lubridate, stringr, or forcats:</em></p>
<ol style="list-style-type: decimal">
<li>tibble() - tidyr</li>
<li>filter() - dplyr</li>
<li>pull() - dplyr</li>
<li>rename() - dplyr</li>
<li>bind_cols() - dplyr</li>
<li>gather() - tidyr</li>
<li>str_wrap() - stringr</li>
</ol>
<p><em>You must use at least two functions from purrr:</em></p>
<ol style="list-style-type: decimal">
<li>map_dbl() - purrr</li>
<li>map() - purrr</li>
</ol>
<p><em>Your analysis should include at least three plots with you using
at least three different geom_() functions from ggplot2 (or another
package with geom_() functions)“:</em></p>
<ol style="list-style-type: decimal">
<li>geom_point() - ggplot2</li>
<li>geom_histogram() - ggplot2</li>
<li>geom_smooth() - ggplot2</li>
</ol>
<p><em>At least one plot should using a type of faceting (facet_grid()
or facet_wrap()).:</em></p>
<ul>
<li>Got it!</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Caleb Hallinan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Package is not guaranteed to run, please submit pull requests with issues.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
